---
title: "Does Humor Impact  Dating Success?"
Team member: "Brian Xiao, Erin Reed, KT Norton, Luka Liu and Quazi Fairooz"
date: "12/11/2023"
output: 
  pdf_document: 
    number_sections: true
---

```{r package loads, include=FALSE, warning=FALSE}
# install.packages("pwr") need to install if you don't have it yet
library(pwr)
library(data.table)
library(sandwich)
library(lmtest)

library(ggplot2)
library(knitr)
library(stargazer)
```

# Abstract
This study investigates the user personalities displayed on dating app profiles and their subsequent engagement levels. By comparing the effects of creating a neutral personality profile with crafting a highly humorous and intriguing personality description, we aim to examine the impact of varying personality portrayals in dating app profiles (independent of accompanying photos) on user interactions and engagement. Our experiment generated the following results: dating profiles with humorous textual cues received XX as many likes and XX matches. XXX statistically significant. We suspect primary factors like photographs and demographic backgrounds have a greater influence on first impressions (views) rather than dating pursuits (matches). These results can be beneficial for online dating app users as they evaluate where to spend most of their time when they develop their dating profiles.

# Introduction
Humor is a universal human experience that promotes bonding and positive social interaction. Historically, humor has been shown to decrease social tension and increase likability. The treatment involving the use of humor in the description is expected to change the measured behavior of humans who receive it. In the context of dating, where first impressions are critical, a humorous profile may pique interest by presenting someone as relatable, fun, and approachable, thereby increasing the chances of having dating success. 

Our team is interested in investigating whether humorous expressions through textual cues affect dating success on a dating app. Current academic literature has evaluated this concept in similar, yet different, ways. First, a research study has evaluated how messages with different levels of humor impact a person’s perceived attractiveness (Garove and Farley, 2015). Second, a research study evaluated how live humor and laughter in discourse are associated with perceived attractiveness (Hall, 2015). Lastly, a few research studies have evaluated attractiveness (Fiore et all, 2008) or first impressions (Zanden, 2021) specifically within dating apps. However, none of these research studies evaluate whether humorous textual cues within a dating app affect a person’s attractiveness when primary cues like photographs and demographic information remain constant.

# Experiment Concept
People spend hours daily on dating apps looking for potential partners. The selection process gets more complicated with the increase in the abundance of options available to them. While the superficial qualities and end goals are highly esteemed,  a profile with a humorous caption tends to stand out among the numerous mundane ones as it indicates a witty personality, something which is not easily captured through just pictures and usual descriptions. 

Our intervention variable is textual differences between the two Hinge dating profiles. Our subjects will experience a dating profile that is humorous and fun (treatment) and a dating profile that is plain and unimaginative (control). To reduce noise driven by confounding variables, we plan to ensure both profiles have the same characteristics and content apart from responses to question prompts. Controlling for these other factors is an important feature of this experience because while studies have shown that photos and demographics heavily influence dating profile experiences, this experiment is meant to focus on the causal effect personality traits expressed through text can have on someone's dating success on Hinge.

Due to limitations in timing and resources, we are utilizing only the Hinge application, but if we could replicate the results on other dating apps such as Tinder or Bumble, we hope to see similar results.

# Experiment Design
The objective of this experiment is to explore the impact of incorporating a humorous personality into dating app profiles on user engagement. Specifically, we will compare the effects of creating a neutral personality profile with crafting a highly humorous and intriguing personality description on user interactions and engagement. We target the participants to be a diverse group of participants aged 18-25. Participants’ profile photos will be the same to ensure that the study focuses solely on the impact of the humorous personality. Each of our team members will create fake profiles for both control and treatment groups based on the same photo. In the control group, the profile will be created as a neutral personality profile while in the treatment group, the profile will be created as a highly humorous and intriguing personality in the description. The fake profile will launch at the same time on the dating app for a specified period of time(e.g. 4-6 weeks). The number of likes and matches will be the key metric we are going to measure. 

We have chosen two locations in the United States— New York City and San Francisco to introduce the fictitious dating profiles. The underlying assumption is that users of the dating app from these two U.S. locations will exhibit similar reactions regardless of whether a humorous personality is presented or not. Our intention is to keep other demographic differences to a minimum to strengthen this assumption. Moreover, to prevent a single participant from encountering two identical profiles simultaneously, we have made the deliberate decision to launch identical profiles in different locations. For instance, one profile (the control group) will be launched in San Francisco, while the other profile (the treatment group) will be launched in Los Angeles. This collection of data will serve as a foundational reference point, aiding us in ensuring that the two groups—those exposed to a neutral personality profile and those exposed to a humorous personality description—are comparable in terms of their demographic characteristics. It also safeguards against the possibility of a single individual viewing both profiles concurrently.

Since the control/treatment profile will be launched at the same time, the engagement metrics, such as the number of matches, likes, and comments will be zero as a baseline. The following variables are measured after the treatment (ie. activating the fake profile) to assess the impact on user engagement. 

Number of profile likes: How many users have liked the profile
Number of comments: How many users have commented on the profile
Number of matches: How many users have matched with the profile

Dating apps necessitate mutual likes for a match to occur, for example, if one profile swipes right on five people, their maximum potential matches will be limited to five. We will standardize the maximum number of matches each profile can receive after the treatment. This will ensure that our created profile’s actions (how much time we swipe right) do not unduly influence the effectiveness of our measures.

Through these variables both before and after administering the treatment, we can assess how the humor personality influenced user engagement on dating apps.

Due to the nature of this experiment creating fake dating profiles for our sample, our team will make up the participants of this experiment. Each team member will create 2 (or 4) dating profiles - one for control and one for treatment. These profiles will be identical in everything except for the profile question prompts, which will be neutral in control and humorous in treatment.

# Data Cleaning

The provided dataset records essential metrics—swipes, likes, matches, and comments—for various user profiles on distinct dates, classified into control and treatment groups. It encompasses information pertaining to user profiles within a dating application (refer to the Appendix for a detailed description of the table columns). 

We will employ two main tables for our data analysis. The primary focus will be on the 'exp_d' table for evaluating the metric of matches, which is our key criterion. In this table, we expand 10 daily swipes into each row, creating one sample per row. This expansion is justified by the fact that matches can only occur when swipes take place. Consequently, for the evaluation of the likes metric, we will have a total of 2752 samples.


Regarding the metrics of likes and comments, given that they are not strictly contingent on individual swipes, individuals using Hinge might express their interest by liking or commenting on the profile descriptions we've created. In this context, our unit of measurement for one sample will be based on the date of our experiment. This spans a timeframe of 36 days, from October 19th to November 14th, yielding a total of 294 samples.


```{r read hinge data, include=FALSE}
d<- na.omit(fread("data/W241_Hinge_Data_v3.csv"))
setnames(d, "Profile Name", "Profile_Name")
setnames(d, "Control vs Treatment", "Treat")
d[, Treat_binary := as.integer(Treat == "Treatment")]

exp_d<- na.omit(fread("data/w241_matches_only_expanded.csv"))
setnames(exp_d, "Profile Name", "Profile_Name")
setnames(exp_d, "Control vs Treatment", "Treat")
exp_d[, Treat_binary := as.integer(Treat == "Treatment")]
```

```{r show base table}
head(d)
head(exp_d)
```
# Randomization Check
A randomization check was performed to evaluate whether our treatment and control groups make up representative samples. To perform this check two regression models were developed. The first model: null_mod is the simplest and captures the intercept. The second model: full_mod is more complex and includes profile characteristic variables such as: Who created the profile (Owner), The profile's name (Profile), The location -- San Francisco or New York -- the profile is active (City), The day the sample was collected (Day), and the number of swipes taken on the profile (Swipes).


```{r randomness check, include=FALSE}
null_mod <- exp_d[ , lm(Treat_binary ~ 1)]

full_mod <- exp_d[ , lm(Treat_binary ~ 1 + OwnerNum + ProfileNum + City + ExpDay_profile + Swipes)]
```

The first simple model illustrates a 0.502 intercept to support the assumption that both treatment and control groups make up representative samples. However, the more complex model with five covariates captures a small pattern. The City variable has a statistically significant correlation with treatment outcomes. This suggests that different profile locations (San Francisco or New York) contribute to sample differences between the treatment group and the control group.

```{r warning=FALSE}
stargazer(null_mod, full_mod, 
          type = "text",
         covariate.labels = c("Owner", "Profile", "City - San Francisco", "Day", "Swipes", "Intercept")
          )
```
However, while the City variable is statistical significant the impact seems impractically significant at 0.167. 
To further illustrate the minimal impact the City variable has on treatment assignment, we've run an F-test between our two models (null mod, full mod). As suspected, while City location is statistically significant, the difference does not result in material differences in model performance. While variance is higher with our simple model, it still generates the same outcomes as the complex model for 97% of samples.

```{r}
anova_mod <- anova(full_mod, null_mod, test = 'F')
anova_mod
```
# Experimentation

In this section, we dived deeper into the analysis of our experiment, aiming to elucidate the impact of incorporating a humorous personality into dating app profiles while accounting for various control variables. Our primary objective remains consistent: to assess the effect of the treatment variable, denoting the presence of a highly humorous and intriguing personality description within the profile, on user engagement metrics, specifically, the number of likes and matches.

We performed a power analysis simulation before the experiment, in order to ensure a high probability (80%) of detecting a treatment effect of 20%. In this case, a treatment effect of 20% suggests that the study is designed to detect a 20% difference between groups, which could be a treatment group and a control group. A sample size of 400 is recommended for the statistical test being conducted.

```{r power analysis, include=FALSE}

# Set parameters
alpha <- 0.05           # Significance level
power <- 0.8            # Desired power
treatment_effect_sizes <- seq(0.05, 1, by = 0.05)  # Range of treatment effect sizes


# Initialize variables
target_sample_size <- NA
target_effect_size <- NA

# Function to calculate power for a given effect size and sample size
calculate_power <- function(effect_size, sample_size) {
  pwr.t.test(d = effect_size, n = sample_size, sig.level = alpha, type = "two.sample")$power
}

# Iterate through treatment effect sizes and find the combination that achieves the desired power
for (effect_size in treatment_effect_sizes) {
  # Use a range of sample sizes for exploration
  for (sample_size in seq(10, 500, by = 10)) {
    current_power <- calculate_power(effect_size, sample_size)
    
    if (current_power >= power) {
      target_sample_size <- sample_size
      target_effect_size <- effect_size
      break
    }
  }
  
  if (!is.na(target_sample_size)) {
    break
  }
}

# Function to calculate sample size for a given treatment effect size
calculate_sample_size <- function(effect_size, alpha, power) {
  pwr.t.test(d = effect_size, sig.level = alpha, power = power, type = "two.sample")$n
}

# Calculate sample sizes for each treatment effect size
sample_sizes <- sapply(treatment_effect_sizes, calculate_sample_size, alpha = alpha, power = power)

```

```{r plot_power, include=TRUE}
# Plot the results
plot(sample_sizes, treatment_effect_sizes, type = "l", col = "blue",
     xlab = "Sample Size", ylab = "Treatment Effect Size",
     main = "Power Analysis based on treatment effect")

# Add a horizontal line for the desired power
abline(h = target_effect_size, col = "red", lty = 2)
abline(v = target_sample_size, col = "orange", lty = 2)

# Add legend
legend("topright", legend = c("Target Effect Size", "Target Sample Size"), 
       col = c("red", "orange"), lty = c(2, 1))


```

```{r, include=FALSE}
# Print the results
cat("Desired Power:", power, "\n")
cat("Target Sample Size:", target_sample_size, "\n")
cat("Target Treatment Effect Size:", target_effect_size, "\n")

```

This experiment was conducted for 45 days. However, due to unforeseen issues with profiles being removed unexpectedly, we were not able to collect data for all of those days. We were able to get a total of 283 samples in terms of unique profiles collecting data per day. To analyze the number of matches each profile received, we expanded the data for that model so that each sample is actually a single "swipe" or "like" that the profile sent in a day. This means that the outcome variable for each sample is a binary indicator variable indicating whether or not that swipe garnered a match or not. The total number of samples for our match model is 2742.

Analyzing the likes that a profile received is a bit more complicated than that. It is unclear exactly how Hinge decides to show certain profiles to users, so it is impossible to determine the total number of users that actually encoutered our profiles in a given day. Therefore, we will analyze the lkes on a per day sample. That is to say that a single sample represents a single day in our experiment and the outcome variable is the nubmer of likes that a profile received. Thhe total number of samples for our likes model is 283.

## Number of Matches Experiment - Simple

```{r matches_t_test, include=TRUE}
match_d <- exp_d[, c('match',"Treat_binary")]
# Perform a t-test
t_test_matches <- t.test(match ~ Treat_binary, d=match_d) 
t_test_matches
```

Using a t-test, we compared the mean matches between two groups. The t-value is approximately, -3.3309, and the p-value is 0.0008773. The results suggest a statistically significant difference in means between control and treatment, as indicated by the small p-value and the confidence interval(-0.06248673 -0.01617828) that does not include zero. The negative t-value suggests that the mean in treatment is higher than the mean in control."

```{r matches_regression, include=TRUE, warning=FALSE}
mod <- lm(match ~ Treat_binary, data=match_d) 
robust_mod <- coeftest(mod, vcov = vcovHC(mod, type = "HC3"))

stargazer(mod, type = "text", header=FALSE)
```
The 'Treat_binary' coefficient (0.039) indicates that, on average, there is a 0.039-unit increase in the 'match' variable for treatment group, which is 'Treat_binary'= 1. The p-value associated with 'Treat_binary' is highly significant (***p<0.01), suggesting that 'Treat_binary' is a significant predictor of 'match.' Since we are exploring whether there is a significant difference between control and treatment groups in matches, the t-test and a simple linear regression produce a very similar result. 

## Number of Matches Expriment - Comphrehesive 

To further enhance the analysis of the impact of humor on dating app matches, we include additional variables, such as dating app profile, which can capture and account for potential influence on the number of matches, and the city or days of the week. I believe that this helps to isolate the true effect of treat_binary (humor) on matches, reducing extraneous noise and improving the accuracy the estimates. Additionally, including more variables allows you to understand how different factors interact and contribute to the outcome. This creates a more nuanced picture of the relationships between humor and matches, rather than just a single, isolated effect. Lastly, we will be able to reduce the risk of omitted variable bias and obtain more reliable results.

```{r matches_regression_complex, include=TRUE, warning=FALSE}
mod_1 <- lm(match ~ Treat_binary + CityNum, data=exp_d)
robust_mod_1 <- coeftest(mod_1, vcov = vcovHC(mod_1, type = "HC3"))

mod_2 <- lm(match ~ Treat_binary + CityNum + factor(ProfileNum), data=exp_d)
robust_mod_2 <- coeftest(mod_2, vcov = vcovHC(mod_2, type = "HC3"))

mod_3 <- lm(match ~ Treat_binary + CityNum + factor(ProfileNum) + factor(weekday), data=exp_d)
robust_mod_3 <- coeftest(mod_3, vcov = vcovHC(mod_3, type = "HC3"))

mod_4 <- lm(match ~ Treat_binary + CityNum + factor(ProfileNum) + factor(weekday) + ExpDay_profile, data=exp_d)
robust_mod_4 <- coeftest(mod_4, vcov = vcovHC(mod_4, type = "HC3"))

stargazer(
  mod_1,
  mod_2,
  mod_3,
  mod_4,
          type = "text", header=FALSE)

```

## Matches Model Interpretation

Model 1: We included city data (limited to San Francisco and New York City) to assess its potential influence on dating app matches. As anticipated, incorporating humor into profiles significantly increased matches, regardless of city location. This aligns with our assumption that individuals in these two major cities would exhibit similar behavior regarding online dating preferences.

Model 2: By incorporating "profile_id" as a categorical variable in our analysis, we were able to demonstrate that all six profiles exhibited statistically significant differences in their average number of matches compared to the control group. This finding provides valuable insights into how individual profile characteristics influence dating app success and highlights the importance of considering individual variability in such research.

Model 3: This model further expands by incorporating the day of the week the user profile was active (coded as a factor with seven levels). Consistent with the previous model, the results reaffirm that incorporating humor significantly increases the number of matches received, and individual profile characteristics remain influential factors in dating app success. However, similar to city location, weekday does not appear to have a statistically significant impact on match count.

Model 4: This model expands upon previous iterations by incorporating "ExpDay_profile," which signifies the duration since a profile's creation. This addition enables us to examine the relationship between the number of days a profile is active on the app (exposure days) and the number of matches received. The negative coefficient (-0.00238) associated with ExpDay_profile reveals that as the exposure days increase, the average number of matches received decreases. This finding suggests the potential presence of a decay effect, where the initial boost experienced by new profiles gradually diminishes over time. Consequently, the importance of profile refresh or update strategies to sustain user engagement and maintain match potential is highlighted.


## Number of Likes Experiment - Simple

```{r likes_t_test, include=TRUE}
like_d <- d[, c('Likes',"Treat_binary")]

t_test_likes <- t.test(Likes ~ Treat_binary, d=like_d) 
t_test_likes
```
We conducted a t-test to compare the mean number of matches between the treatment and control groups. The resulting t-value was approximately -1.6386, and the corresponding p-value was found to be 0.1025. These outcomes suggest that there is no statistically significant difference in the number of matches between the two groups. 

Furthermore, the 95% confidence interval for the difference in means, (-1.2094231 to 0.1107316), encompasses zero. This observation signifies that we do not have sufficient evidence to establish any statistical significance in the comparison of mean matches between the treatment and control groups.

```{r likes_regression, include=TRUE, warning=FALSE}
mod <- lm(Likes ~ Treat_binary, data=d) 
robust_mod <- coeftest(mod, vcov = vcovHC(mod, type = "HC3"))

stargazer(mod, type = "text", header=FALSE)
```
We conducted a regression analysis to examine the impact of treatment, on the number of 'Likes' received in dating app profiles. The coefficient for the treatment variable is 0.549, indicating that profiles with a humorous personality description (in the treatment group) tend to receive approximately 0.549 more 'Likes' compared to profiles without such descriptions (in the control group). However, this result does not reach statistical significance (p > 0.1), suggesting that the effect of the treatment on 'Likes' is not statistically conclusive.

The constant term in the model is 1.993, representing the estimated number of 'Likes' for profiles in the control group. The overall model explains a small portion of the variability in 'Likes' (R-squared = 0.009) and has a limited ability to predict the number of 'Likes' based on the treatment variable. The F-statistic is 2.680, with a corresponding p-value greater than 0.1, indicating that the model does not provide strong evidence for the relationship between the treatment variable and 'Likes.'

In summary, while there is a positive association between the treatment and the number of 'Likes,' our results do not demonstrate statistical significance. Therefore, the impact of a humorous personality description on the number of 'Likes' in dating app profiles remains inconclusive based on this analysis.

## Number of Matches Expriment - Comphrehesive 
Building upon the foundation laid in the earlier section, where we examined the simple relationships between the treatment variable and our outcome variables, Likes and Matches, we recognize the need to consider a broader context. By doing so, we aim to control for potential confounding variables that might otherwise obscure the true impact of the treatment variable. These control variables encompass demographic and contextual factors, allowing us to explore how the humorous personality description affects user engagement while holding other relevant factors constant.

```{r likes_regression_complex, include=TRUE, warning=FALSE}
mod_1 <- lm(Likes ~ Treat_binary + Swipes, data=d)
robust_mod_1 <- coeftest(mod_1, vcov = vcovHC(mod_1, type = "HC3"))

mod_2 <- lm(Likes ~ Treat_binary + Swipes + CityNum, data=d)
robust_mod_2 <- coeftest(mod_2, vcov = vcovHC(mod_2, type = "HC3"))

mod_3 <- lm(Likes ~ Treat_binary + Swipes + CityNum + factor(Owner), data=d)
robust_mod_2 <- coeftest(mod_3, vcov = vcovHC(mod_3, type = "HC3"))

mod_4 <- lm(Likes ~ Treat_binary + Swipes + CityNum + factor(Owner) + 
              factor(DOW), data=d)
robust_mod_4 <- coeftest(mod_4, vcov = vcovHC(mod_4, type = "HC3"))

mod_5 <- lm(Likes ~ Treat_binary + Swipes + CityNum + factor(Owner) + 
              factor(DOW) + ExpDay, data=d)
robust_mod_5 <- coeftest(mod_5, vcov = vcovHC(mod_5, type = "HC3"))

stargazer(
  mod_1,
  mod_2,
  mod_3,
  mod_4,
  mod_5,
  type = "text", header=FALSE)

```

The coefficient for our binary treatment variable ranges from 0.549 to 0.602 across the different models, suggesting that profiles with a humorous description tend to receive more "Likes" compared to profiles without humor. The p-values associated with these coefficients are all below 0.05, indicating statistical significance. Thus, the presence of humor in the profile has a statistically significant positive impact on the number of "Likes."

The "Swipes" coefficient indicates the number of swipes or likes that the profile gave out in a single day. The coefficients for "Swipes" are positive and range from 0.023 to 0.048 in different models. These positive coefficients suggest that profiles sending more swipes/likes tend to receive more "Likes," and this relationship is statistically significant (p < 0.05) in some models.

Overall, The presence of humor in dating app profiles is associated with an increase in the number of "Likes" and is statistically significant. Other factors such as swipes, specific profile identifiers, and the day of the experiment also influence "Likes." However, the impact of the day of the week and the city of the profile location appears to be less pronounced and often not statistically significant in the presented models.

```{r}
nrow(d)
nrow(exp_d)
```

## Experimentation Results


These results confirm that having a humorous personality description significantly influences user engagement on dating apps, particularly through an increase in both matches and likes. The control variables in these models do not exhibit significant effects on being in the treatment group, reinforcing the importance of personality traits expressed through text in shaping user interactions and experiences on dating apps.


# Appendix
Here is a summary of the data columns:

- Owner: The team member who owns the profile.
- OwnerNum (Categorical): Owner variable transformed into an integer variable
- Profile_Name: The name associated with the profile.
- ProfileNum(Categorical): Profile Name variable transformed into an integer. We have 6 profile name. 
- City: The city where the profile is located.
- CityNum:Integer of city, San Francisco = 0, NYC = 1
- Treat: Indicates whether the profile is in the control group or the treatment group.
- Treat_binary: Logical condition into binary values (0 for "Control" and 1 for "Treatment"). Indicator for the treatment group (humorous profile).
- Date: The date of the recorded data.
- Swipes: The number of times the profile was swiped.we carry out a daily random allocation of 10 swipes in the profiles, both in the control and treatment groups. This measure serves a dual purpose: first, it keeps our profiles actively participating in the app, and second, it facilitates interaction with other profiles, increasing the visibility of our profiles to other users. 
- Likes: The number of likes received by the profile.
- ExpDate_Profile: Date variable transformed into an integer based on the day number in the experiment by profile. Starting from one.
