---
title: "Does Humor Impact  Dating Success?"
Team member: "Brian Xiao, Erin Reed, KT Norton, Luka Liu and Quazi Fairooz"
date: "12/11/2023"
output: 
  pdf_document: 
    number_sections: true
---

```{r package loads, include=FALSE, warning=FALSE}
# install.packages("pwr") need to install if you don't have it yet
library(pwr)
library(data.table)
library(sandwich)
library(lmtest)

library(ggplot2)
library(knitr)
library(stargazer)
```

# Abstract
This study investigates the user personalities displayed on dating app profiles and their subsequent engagement levels. By comparing the effects of creating a neutral personality profile with crafting a highly humorous and intriguing personality description, we aim to examine the impact of varying personality portrayals in dating app profiles (independent of accompanying photos) on user interactions and engagement. Our experiment generated the following results: dating profiles with humorous textual cues received XX as many likes and XX matches. XXX statistically significant. We suspect primary factors like photographs and demographic backgrounds have a greater influence on first impressions (views) rather than dating pursuits (matches). These results can be beneficial for online dating app users as they evaluate where to spend most of their time when they develop their dating profiles.

# Introducation
Humor is a universal human experience that promotes bonding and positive social interaction. Historically, humor has been shown to decrease social tension and increase likability. The treatment involving the use of humor in the description is expected to change the measured behavior of humans who receive it. In the context of dating, where first impressions are critical, a humorous profile may pique interest by presenting someone as relatable, fun, and approachable, thereby increasing the chances of having dating success. 

Our team is interested in investigating whether humorous expressions through textual cues affect dating success on a dating app. Current academic literature has evaluated this concept in similar, yet different, ways. First, a research study has evaluated how messages with different levels of humor impact a person’s perceived attractiveness (Garove and Farley, 2015). Second, a research study evaluated how live humor and laughter in discourse are associated with perceived attractiveness (Hall, 2015). Lastly, a few research studies have evaluated attractiveness (Fiore et all, 2008) or first impressions (Zanden, 2021) specifically within dating apps. However, none of these research studies evaluate whether humorous textual cues within a dating app affect a person’s attractiveness when primary cues like photographs and demographic information remain constant.

# Experiment Concept
People spend hours daily on dating apps looking for potential partners. The selection process gets more complicated with the increase in the abundance of options available to them. While the superficial qualities and end goals are highly esteemed,  a profile with a humorous caption tends to stand out among the numerous mundane ones as it indicates a witty personality, something which is not easily captured through just pictures and usual descriptions. 

Our intervention variable is textual differences between the two Hinge dating profiles. Our subjects will experience a dating profile that is humorous and fun (treatment) and a dating profile that is plain and unimaginative (control). To reduce noise driven by confounding variables, we plan to ensure both profiles have the same characteristics and content apart from responses to question prompts. Controlling for these other factors is an important feature of this experience because while studies have shown that photos and demographics heavily influence dating profile experiences, this experiment is meant to focus on the causal effect personality traits expressed through text can have on someone's dating success on Hinge.

Due to limitations in timing and resources, we are utilizing only the Hinge application, but if we could replicate the results on other dating apps such as Tinder or Bumble, we hope to see similar results.

# Experiment Design
The objective of this experiment is to explore the impact of incorporating a humorous personality into dating app profiles on user engagement. Specifically, we will compare the effects of creating a neutral personality profile with crafting a highly humorous and intriguing personality description on user interactions and engagement. We target the participants to be a diverse group of participants aged 18-25. Participants’ profile photos will be the same to ensure that the study focuses solely on the impact of the humorous personality. Each of our team members will create fake profiles for both control and treatment groups based on the same photo. In the control group, the profile will be created as a neutral personality profile while in the treatment group, the profile will be created as a highly humorous and intriguing personality in the description. The fake profile will launch at the same time on the dating app for a specified period of time(e.g. 4-6 weeks). The number of likes and matches will be the key metric we are going to measure. 

We have chosen two locations in the United States— New York City and San Francisco to introduce the fictitious dating profiles. The underlying assumption is that users of the dating app from these two U.S. locations will exhibit similar reactions regardless of whether a humorous personality is presented or not. Our intention is to keep other demographic differences to a minimum to strengthen this assumption. Moreover, to prevent a single participant from encountering two identical profiles simultaneously, we have made the deliberate decision to launch identical profiles in different locations. For instance, one profile (the control group) will be launched in San Francisco, while the other profile (the treatment group) will be launched in Los Angeles. This collection of data will serve as a foundational reference point, aiding us in ensuring that the two groups—those exposed to a neutral personality profile and those exposed to a humorous personality description—are comparable in terms of their demographic characteristics. It also safeguards against the possibility of a single individual viewing both profiles concurrently.

Since the control/treatment profile will be launched at the same time, the engagement metrics, such as the number of matches, likes, and comments will be zero as a baseline. The following variables are measured after the treatment (ie. activating the fake profile) to assess the impact on user engagement. 

Number of profile likes: How many users have liked the profile
Number of comments: How many users have commented on the profile
Number of matches: How many users have matched with the profile

Dating apps necessitate mutual likes for a match to occur, for example, if one profile swipes right on five people, their maximum potential matches will be limited to five. We will standardize the maximum number of matches each profile can receive after the treatment. This will ensure that our created profile’s actions (how much time we swipe right) do not unduly influence the effectiveness of our measures.

Through these variables both before and after administering the treatment, we can assess how the humor personality influenced user engagement on dating apps.

Due to the nature of this experiment creating fake dating profiles for our sample, our team will make up the participants of this experiment. Each team member will create 2 (or 4) dating profiles - one for control and one for treatment. These profiles will be identical in everything except for the profile question prompts, which will be neutral in control and humorous in treatment.

# Data Cleaning

The provided dataset records essential metrics—swipes, likes, matches, and comments—for various user profiles on distinct dates, classified into control and treatment groups. It encompasses information pertaining to user profiles within a dating application (refer to the Appendix for a detailed description of the table columns). 

We will employ two main tables for our data analysis. The primary focus will be on the 'exp_d' table for evaluating the metric of matches, which is our key criterion. In this table, we expand 10 daily swipes into each row, creating one sample per row. This expansion is justified by the fact that matches can only occur when swipes take place. Consequently, for the evaluation of the likes metric, we will have a total of 2752 samples.


Regarding the metrics of likes and comments, given that they are not strictly contingent on individual swipes, individuals using Hinge might express their interest by liking or commenting on the profile descriptions we've created. In this context, our unit of measurement for one sample will be based on the date of our experiment. This spans a timeframe of 36 days, from October 19th to November 14th, yielding a total of 294 samples.


```{r read hinge data, include=FALSE}
d<- na.omit(fread("/home/rstudio/Final_project/data/W241_Hinge_Data_v2.csv"))
setnames(d, "Profile Name", "Profile_Name")
setnames(d, "Control vs Treatment", "Treat")
d[, Treat_binary := as.integer(Treat == "Treatment")]

exp_d<- na.omit(fread("/home/rstudio/Final_project/data/w241_matches_only_expanded.csv"))
setnames(exp_d, "Profile Name", "Profile_Name")
setnames(exp_d, "Control vs Treatment", "Treat")
exp_d[, Treat_binary := as.integer(Treat == "Treatment")]
```

```{r show base table}
head(d)
head(exp_d)

```
# Randomization Check
A randomization check was performed to evaluate whether our treatment and control groups make up representative samples. To perform this check two regression models were developed. The first model: null_mod is the simplest and captures the intercept. The second model: full_mod is more complex and includes profile characteristic variables such as: Who created the profile (Owner), The profile's name (Profile), The location -- San Francisco or New York -- the profile is active (City), The day the sample was collected (Day), and the number of swipes taken on the profile (Swipes).


```{r randomness check, include=FALSE}
null_mod <- exp_d[ , lm(Treat_binary ~ 1)]

full_mod <- exp_d[ , lm(Treat_binary ~ 1 + OwnerNum + ProfileNum + City + ExpDay_profile + Swipes)]
```

The first simple model illustrates a 0.502 intercept to support the assumption that both treatment and control groups make up representative samples. However, the more complex model with five covariates captures a small pattern. The City variable has a statistically significant correlation with treatment outcomes. This suggests that different profile locations (San Francisco or New York) contribute to sample differences between the treatment group and the control group.

```{r warning=FALSE}
stargazer(null_mod, full_mod, 
          type = "text",
         covariate.labels = c("Owner", "Profile", "City - San Francisco", "Day", "Swipes", "Intercept")
          )
```
However, while the City variable is statistical significant the impact seems impractically significant at 0.167. 
To further illustrate the minimal impact the City variable has on treatment assignment, we've run an F-test between our two models (null mod, full mod). As suspected, while City location is statistically significant, the difference does not result in material differences in model performance. While variance is higher with our simple model, it still generates the same outcomes as the complex model for 97% of samples.

```{r}
anova_mod <- anova(full_mod, null_mod, test = 'F')
anova_mod
```
# Experimentation

In this section, we delve deeper into the analysis of our experiment, aiming to elucidate the impact of incorporating a humorous personality into dating app profiles while accounting for various control variables. Our primary objective remains consistent: to assess the effect of the treatment variable, denoting the presence of a highly humorous and intriguing personality description within the profile, on user engagement metrics, specifically, the number of likes and matches.

Referring to our power analysis simulation we performed in the past, in order to ensure a high probability (80%) of detecting a treatment effect of 20% (In this case, a treatment effect of 20% suggests that the study is designed to detect a 20% difference between groups, which could be a treatment group and a control group), a sample size of 400 is recommended for the statistical test being conducted. 

```{r power analysis, include=FALSE}

# Set parameters
alpha <- 0.05           # Significance level
power <- 0.8            # Desired power
treatment_effect_sizes <- seq(0.05, 1, by = 0.05)  # Range of treatment effect sizes


# Initialize variables
target_sample_size <- NA
target_effect_size <- NA

# Function to calculate power for a given effect size and sample size
calculate_power <- function(effect_size, sample_size) {
  pwr.t.test(d = effect_size, n = sample_size, sig.level = alpha, type = "two.sample")$power
}

# Iterate through treatment effect sizes and find the combination that achieves the desired power
for (effect_size in treatment_effect_sizes) {
  # Use a range of sample sizes for exploration
  for (sample_size in seq(10, 500, by = 10)) {
    current_power <- calculate_power(effect_size, sample_size)
    
    if (current_power >= power) {
      target_sample_size <- sample_size
      target_effect_size <- effect_size
      break
    }
  }
  
  if (!is.na(target_sample_size)) {
    break
  }
}

# Function to calculate sample size for a given treatment effect size
calculate_sample_size <- function(effect_size, alpha, power) {
  pwr.t.test(d = effect_size, sig.level = alpha, power = power, type = "two.sample")$n
}

# Calculate sample sizes for each treatment effect size
sample_sizes <- sapply(treatment_effect_sizes, calculate_sample_size, alpha = alpha, power = power)

```

```{r plot_power, include=TRUE}
# Plot the results
plot(sample_sizes, treatment_effect_sizes, type = "l", col = "blue",
     xlab = "Sample Size", ylab = "Treatment Effect Size",
     main = "Power Analysis based on treatment effect")

# Add a horizontal line for the desired power
abline(h = target_effect_size, col = "red", lty = 2)
abline(v = target_sample_size, col = "orange", lty = 2)

# Add legend
legend("topright", legend = c("Target Effect Size", "Target Sample Size"), 
       col = c("red", "orange"), lty = c(2, 1))


```

```{r, include=FALSE}
# Print the results
cat("Desired Power:", power, "\n")
cat("Target Sample Size:", target_sample_size, "\n")
cat("Target Treatment Effect Size:", target_effect_size, "\n")

```

## Number of Matches Expriment

```{r likes_t_test, include=TRUE}
match_d <- exp_d[, c('match',"Treat_binary")]
# Perform a t-test
t_test_matches <- t.test(match ~ Treat_binary, d=match_d) 
t_test_matches
```

Using a t-test, we compared the mean matches between two groups. The t-value is approximately, -3.3309, and the p-value is 0.0008773. The results suggest a statistically significant difference in means between control and treatment, as indicated by the small p-value and the confidence interval(-0.06248673 -0.01617828) that does not include zero. The negative t-value suggests that the mean in treatment is higher than the mean in control."

```{r matches_regression, include=TRUE, warning=FALSE}
mod <- lm(match ~ Treat_binary, data=match_d) 
robust_mod <- coeftest(mod, vcov = vcovHC(mod, type = "HC3"))

stargazer(mod, type = "text", header=FALSE)
```
The 'Treat_binary' coefficient (0.039) indicates that, on average, there is a 0.039-unit increase in the 'match' variable for a one-unit increase in 'Treat_binary.'The p-value associated with 'Treat_binary' is highly significant (***p<0.01), suggesting that 'Treat_binary' is a significant predictor of 'match.' Since we are exploring whether there is a significant difference between control and treatment groups in matches, the t-test and a simple linear regression produce a very similar result. 


## Simple Causal Experiment
```{r warning=FALSE}
simple_match_model <- d[ , lm(Treat_binary ~ Matches, data = d)]
simple_like_model <- d[ , lm(Treat_binary ~ Likes, data = d)]


robust_match_model <- coeftest(simple_match_model, 
                               vcov = vcovHC(simple_match_model, type = "HC3"))
robust_like_model <- coeftest(simple_like_model, 
                              vcov = vcovHC(simple_like_model, type = "HC3"))

stargazer(robust_match_model, robust_like_model, 
          type = "text", header=FALSE)

simple_match_model_1 <- d[ , glm(Treat_binary ~ Matches, family = "binomial", data = d)]
simple_like_model_1 <- d[ , glm(Treat_binary ~ Likes, family = "binomial", data = d)]


robust_match_model_1 <- coeftest(simple_match_model_1, 
                               vcov = vcovHC(simple_match_model_1, type = "HC3"))
robust_like_model_1 <- coeftest(simple_like_model_1, 
                              vcov = vcovHC(simple_like_model_1, type = "HC3"))

stargazer(robust_match_model_1, robust_like_model_1, 
          type = "text", header=FALSE)

simple_match_model_2 <- d[ , lm(Matches ~ Treat_binary,  data = d)]
simple_like_model_2 <- d[ , lm(Likes ~ Treat_binary, data = d)]


robust_match_model_2 <- coeftest(simple_match_model_2, 
                               vcov = vcovHC(simple_match_model_2, type = "HC3"))
robust_like_model_2 <- coeftest(simple_like_model_2, 
                              vcov = vcovHC(simple_match_model_2, type = "HC3"))

stargazer(robust_match_model_2, robust_like_model_2, 
          type = "text", header=FALSE)

simple_match_model_3 <- d[ , glm(Matches ~ Treat_binary, family = "poisson", data = d)]
simple_like_model_3 <- d[ , glm(Likes ~ Treat_binary, family = "poisson", data = d)]
summary(simple_match_model_3)


robust_match_model_3 <- coeftest(simple_match_model_3, 
                               vcov = vcovHC(simple_match_model_3, type = "HC3"))
robust_like_model_3 <- coeftest(simple_like_model_3, 
                              vcov = vcovHC(simple_like_model_3, type = "HC3"))

stargazer(robust_match_model_3, robust_like_model_3, 
          type = "text", header=FALSE)



```
### Model 1: Humor ~ Matches

Model 1 examines the impact of our treatment variable on the number of matches. For each additional match, the likelihood of being in the treatment group (having a humorous personality description) increases by approximately 0.076 units. The coefficient for matches is highly statistically significant (p < 0.01), indicating a strong and robust relationship between the number of matches and being in the treatment group. 

### Model 2: Humor ~ Likes

Model 2 examines the impact of our treatment variable on the number of likes. For each additional like received, there is a marginal increase (0.017 units) in the likelihood of being in the treatment group (having a humorous personality description).
The coefficient for Likes is statistically significant at the 10% level (p < 0.1), indicating a weaker relationship between the number of likes and being in the treatment group compared to Model 1.

In summary, Model 1 demonstrates a robust and highly significant relationship between the number of matches and being in the treatment group, with a substantial increase in the likelihood of having a humorous personality description for each additional match. Model 2, while statistically significant, indicates a weaker relationship between the number of likes and being in the treatment group, with a smaller increase in likelihood per additional like compared to matches. These results emphasize the importance of matches in influencing the likelihood of a humorous personality description in dating profiles.

## Causal Experiments with More Controls
Building upon the foundation laid in the earlier section, where we examined the simple relationships between the treatment variable and our outcome variables, Likes, Matches, and Comments, we recognize the need to consider a broader context. While those initial analyses provided valuable insights into the direct effects of the humorous personality description, they may not account for other factors that could influence user engagement on dating apps.

To address this, we embark on a more comprehensive analytical journey by introducing additional control variables into our regression models. By doing so, we aim to control for potential confounding variables that might otherwise obscure the true impact of the treatment variable. These control variables encompass demographic and contextual factors, allowing us to explore how the humorous personality description affects user engagement while holding other relevant factors constant.

```{r warning=FALSE}
controls_match_model <- d[ , lm(Treat_binary ~ Matches + Swipes+ factor(Owner) + 
                                  factor(City) + factor(ExpDay))]
controls_like_model <- d[ , lm(Treat_binary ~ Likes + Swipes+ factor(Owner) + 
                                 factor(City) + factor(ExpDay))]

robust_controls_match_model <- coeftest(controls_match_model, 
                              vcov = vcovHC(controls_match_model, type = "HC3"))
robust_controls_like_model <- coeftest(controls_like_model, 
                              vcov = vcovHC(controls_like_model, type = "HC3"))

stargazer(robust_controls_match_model, robust_controls_like_model, 
          omit = "factor(ExpDay)", type = "text", header=FALSE)
```

### Model 1: Humor ~ Matches + Controls
Model 1 examines the impact of our treatment variable on the number of matches to include additional control variables (profile owner, profile location, and day of experiment).
The coefficient for Matches is 0.095, and it is highly statistically significant (p < 0.01). This indicates that for each additional match, the likelihood of being in the treatment group (having a humorous personality description) increases significantly by approximately 0.094 units, after controlling for other variables.
The coefficient for Swipes is not statistically significant (p > 0.1), suggesting that the number of swipes does not have a significant effect on being in the treatment group.
The coefficients for the different levels of the Owner variable (e.g., Erin Smith, KT, Luka, Quazi) represent how each owner's profile relates to being in the treatment group compared to a reference category. None of these coefficients are statistically significant at conventional levels (p > 0.1), indicating that the owner's identity does not have a significant effect on being in the treatment group.
The coefficient for the San Francisco city dummy variable is 0.127, and it is marginally statistically significant at the 10% level (p < 0.1). This suggests that being located in San Francisco may have a slight positive impact on being in the treatment group, although the significance level is not very strong.
The coefficients for the different days (ExpDay 2 to 45) represent how each day of the experiment relates to being in the treatment group compared to a reference category. Most of these coefficients are not statistically significant (p > 0.1), suggesting that specific days do not have a significant effect on being in the treatment group.


### Model 2: Humor ~ Likes + Controls
Model 2 examines the impact of our treatment variable on the number of likes to include additional control variables (profile owner, profile location, and day of experiment).
The coefficient for Likes is 0.033, and it is statistically significant at the 5% level (p < 0.05). This indicates that for each additional like received, there is a statistically significant increase of approximately 0.033 units in the likelihood of being in the treatment group (having a humorous personality description), after controlling for other variables.
Similar to Model 1, the coefficients for swipes and the different levels of the Owner variable do not reach statistical significance (p > 0.1), suggesting that both swipes and the owner's identity does not significantly affect being in the treatment group.
The coefficient for the San Francisco city dummy variable is 0.140, and it is statistically significant at the 5% level (p < 0.05). This indicates that being located in San Francisco has a statistically significant positive impact on being in the treatment group.

In both models, Matches (in Model 1) and Likes (in Model 2) have a statistically significant impact on being in the treatment group, with Matches being highly significant and Likes being significant at the 5% level. This suggests that both the number of matches and the number of likes influence the likelihood of having a humorous personality description in dating app profiles.

Regarding the control variables Owner and City, none of the specific owner identities significantly affect being in the treatment group in either model. However, the city variable shows some significance, with being located in San Francisco positively associated with being in the treatment group.

## Experimentation Results
Overall, these results confirm that having a humorous personality description significantly influences user engagement on dating apps, particularly through an increase in both matches and likes. The control variables in these models do not exhibit significant effects on being in the treatment group, reinforcing the importance of personality traits expressed through text in shaping user interactions and experiences on dating apps.


# Appendix
Here is a summary of the data columns:

- Owner: The team member who owns the profile.
- OwnerNum (Categorical): Owner variable transformed into an integer variable
- Profile_Name: The name associated with the profile.
- ProfileNum(Categorical): Profile Name variable transformed into an integer. We have 6 profile name. 
- City: The city where the profile is located.
- CityNum:Integer of city, San Francisco = 0, NYC = 1
- Treat: Indicates whether the profile is in the control group or the treatment group.
- Treat_binary: Logical condition into binary values (0 for "Control" and 1 for "Treatment").
- Date: The date of the recorded data.
- Swipes: The number of times the profile was swiped.we carry out a daily random allocation of 10 swipes in the profiles, both in the control and treatment groups. This measure serves a dual purpose: first, it keeps our profiles actively participating in the app, and second, it facilitates interaction with other profiles, increasing the visibility of our profiles to other users. 
- Likes: The number of likes received by the profile.
- ExpDate_Profile: Date variable transformed into an integer based on the day number in the experiment by profile. Starting from one.
